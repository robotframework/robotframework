Creating test cases
-------------------

This section describes the overall test case syntax. Organizing test
cases into `test suites`_ using `test case files`_ and `test suite
directories`_ is discussed in the next section.

.. contents:: 
   :depth: 2
   :local: 


Test case syntax
~~~~~~~~~~~~~~~~

Basic syntax
''''''''''''

Test cases are constructed in test case tables from the available
keywords. Keywords can be imported from `test libraries`_ or `resource
files`_, or created in the `keyword table`_ of the test case file
itself.

.. _keyword table: `user keywords`_

The first column in the test case table contains test case names. A
test case starts from the row with something in this column and
continues to the next test case name or to the end of the table. It is
an error to have something between the table headers and the first
test.

The second column normally has keyword names. An exception to this rule
is `setting variables from keyword return values`_, when the second and
possibly also the subsequent columns contain variable names and a keyword
name is located after them. In either case, columns after the keyword name
contain possible arguments to the specified keyword.

.. _setting variables from keyword return values: `User keyword return values`_

.. _example-tests:
.. table:: Example test cases
   :class: example

   ==================  ===========================  ==================  ===============
       Test Case                  Action                 Argument          Argument
   ==================  ===========================  ==================  ===============
   Valid Login         Open Login Page              \                   \
   \                   Input Name                   demo                \
   \                   Input Password               mode                \
   \                   Submit Credentials           \                   \
   \                   Welcome Page Should Be Open  \                   \
   \                   \                            \                   \
   Setting Variables   Do Something                 first argument      second argument
   \                   ${value} =                   Get Some Value      \
   \                   Should Be Equal              ${value}            Expected value
   ==================  ===========================  ==================  ===============


Settings in the Test Case table
'''''''''''''''''''''''''''''''

Test cases can also have their own settings. Setting names are always
in the second column, where keywords normally are, and their values
are in the subsequent columns. Setting names have square brackets around
them to distinguish them from keywords. The available settings are listed
below and explained later in this section.

`[Documentation]`:opt:
    Used for specifying a `test case documentation`_.

`[Tags]`:opt:
    Used for `tagging test cases`_.

`[Setup]`:opt:, `[Teardown]`:opt:
   Specify `test setup and teardown`_. Have also synonyms
   :opt:`[Precondition]` and :opt:`[Postcondition]`,
   respectively. 

`[Timeout]`:opt:
   Used for setting a `test case timeout`_. Timeouts_ are discussed in
   their own section.


.. table:: Example test case with settings
   :class: example

   ==================  ===========================  ==================  ===============
       Test Case                  Action                 Argument          Argument
   ==================  ===========================  ==================  ===============
   Test With Settings  [Documentation]              Another dummy test  \
   \                   [Tags]                       dummy               owner-johndoe
   \                   Log                          Hello, world!       \
   ==================  ===========================  ==================  ===============


Test-case-related settings in the Setting table
'''''''''''''''''''''''''''''''''''''''''''''''

The Setting table can have the following test-case-related
settings. These settings are mainly default values for the
test-case-specific settings listed earlier.

`Force Tags`:opt:, `Default Tags`:opt:
   The forced and default values for tags_.

`Test Setup`:opt:, `Test Teardown`:opt:
   The default values for `test setup and teardown`_. Have also synonyms 
   :opt:`Test Precondition` and :opt:`Test Postcondition`,
   respectively.  

`Test Timeout`:opt:
   The default value for `test case timeout`_. Timeouts_ are discussed in
   their own section.


Test case name and documentation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The test case name comes directly from the Test Case table: it is
exactly what is entered into the test case column. Test cases in one
test suite should have unique names.  Pertaining to this, you can also
use the `automatic variable`_ :var:`${TEST_NAME}` within the test
itself to refer to the test name. It is available whenever a test is
being executed, including all user keywords, as well as the test setup
and the test teardown.

The :opt:`[Documentation]` setting allows you to set a free
documentation for a test case. That text is shown in the command line
output, as well as the resulting test logs and test reports. If the
documentation is long, it can be `split into several cells`__ that are
catenated together with spaces. It is possible to use simple `HTML
formatting`_ and variables_ can be used to make the documentation
dynamic. Possible non-existing variables in documentation are
just left unchanged starting from Robot Framework 2.1 version.

__ `Dividing test data to several rows`_

.. table:: Test case documentation examples
   :class: example

   +--------------+-----------------+----------------------+----------------------------+
   |  Test Case   |     Action      |       Argument       |           Argument         |
   +==============+=================+======================+============================+
   | Simple       | [Documentation] | Simple documentation |                            |
   +--------------+-----------------+----------------------+----------------------------+
   |              | No Operation    |                      |                            |
   +--------------+-----------------+----------------------+----------------------------+
   | Splitting    | [Documentation] | This documentation   | it has been split into     |
   |              |                 | is a bit longer and  | several columns.           |
   +--------------+-----------------+----------------------+----------------------------+
   |              | No Operation    |                      |                            |
   +--------------+-----------------+----------------------+----------------------------+
   | Formatting   | [Documentation] | \*This is bold\*,    | here is a link:            |
   |              |                 | \_this italic\_  and | \http://robotframework.org |
   +--------------+-----------------+----------------------+----------------------------+
   |              | No Operation    |                      |                            |
   +--------------+-----------------+----------------------+----------------------------+
   | Variables    | [Documentation] | Executed at ${HOST}  |                            |
   |              |                 | by ${USER}           |                            |
   +--------------+-----------------+----------------------+----------------------------+
   |              | No Operation    |                      |                            |
   +--------------+-----------------+----------------------+----------------------------+

It is important that test cases have clear and descriptive names, and
in that case they normally do not need any documentation. If the logic
of the test case needs documenting, it is often a sign that keywords
in the test case need better names and they are to be enhanced,
instead of adding extra documentation. Finally, metadata, such as the
environment and user information in the last example above, is often
better specified using tags_. 


Tagging test cases
~~~~~~~~~~~~~~~~~~

Using tags in Robot Framework is a simple, yet powerful mechanism for
classifying test cases. Tags are free text and they can be used at
least for the following purposes:

- Tags are shown in test reports_, logs_ and, of course, in the test
  data, so they provide metadata to test cases.
- Statistics__ about test cases (total, passed, failed  are 
  automatically collected based on tags.
- With tags, you can `include or exclude`__ test cases to be executed.
- With tags, you can specify which test cases are considered `critical`_.

__ `Configuring statistics`_
__ `By tag names`_

In this section it is only explained how to set tags for test
cases, and different ways to do it are listed below. These
approaches can naturally be used together.

`Force Tags`:opt: in the Setting table 
   All test cases in a test case file with this setting always get
   specified tags. If it is used in the `test suite initialization file`,
   all test cases in sub test suites get these tags.

`Default Tags`:opt: in the Setting table
   Test cases that do not have a :opt:`[Tags]` setting of their own
   get these tags. If it used in the test suite initialization file,
   it is interpreted as a default value for :opt:`Default Tags` in
   lower-level test suites.

`[Tags]`:opt: in the Test Case table
   A test case always gets these tags. Additionally, it does not get the
   possible tags specified with :opt:`Default Tags`.

`--settag`:opt: command line option
   All executed test cases get tags set with this option in addition
   to tags they got elsewhere.

`Set Tags`:name: and `Remove Tags`:name: keywords 
   These `BuiltIn keywords`_ can be used to modify tags during the
   test execution.

Tags are free text, but they are normalized so that they are converted
to lowercase and all spaces are removed. If a test case gets the same tag
several times, other occurrences than the first one are removed. Tags
can be created using variables, assuming that those variables exist.

.. table:: Tagging example
   :class: example

   ============  ==========  =======  =======  
     Setting       Value      Value    Value   
   ============  ==========  =======  =======  
   Force Tags    req-42      \        \
   Default Tags  owner-john  smoke    \
   ============  ==========  =======  =======  

.. table:: 
   :class: example

   ==========  =========  =======  =======  
    Variable     Value     Value    Value   
   ==========  =========  =======  =======  
   ${HOST}     10.0.1.42  \        \
   ==========  =========  =======  =======  

.. table:: 
   :class: example

   +---------------+-----------------+---------------------+------------------------+
   |   Test Case   |     Action      |       Argument      |         Argument       |
   +===============+=================+=====================+========================+
   | No own tags   | [Documentation] | This test has tags  | owner-john, smoke,     |
   |               |                 |                     | req-42                 |
   +---------------+-----------------+---------------------+------------------------+
   |               | No Operation    |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               |                 |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   | With own tags | [Documentation] | This test has tags  | not_ready, owner-mrx,  |
   |               |                 |                     | req-42                 |
   +---------------+-----------------+---------------------+------------------------+
   |               | [Tags]          | owner-mrx           | not_ready              |
   +---------------+-----------------+---------------------+------------------------+
   |               | No Operation    |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               |                 |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   | Own tags with | [Documentation] | This test has tags  | host-10.0.1.42, req-42 |
   | variables     |                 |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               | [Tags]          | host-${HOST}        |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               | No Operation    |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               |                 |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   | Empty own tags| [Documentation] | This test has tags  | req-42                 |
   +---------------+-----------------+---------------------+------------------------+
   |               | [Tags]          |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               | No Operation    |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               |                 |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   | Set Tags and  | [Documentation] | This test has tags  | mytag, owner-john      |
   | Remove Tags   |                 |                     |                        |
   | Keywords      |                 |                     |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               | Set Tags        | mytag               |                        |
   +---------------+-----------------+---------------------+------------------------+
   |               | Remove Tags     | smoke               | req-*                  |
   +---------------+-----------------+---------------------+------------------------+


Test setup and teardown
~~~~~~~~~~~~~~~~~~~~~~~

Robot Framework has similar test setup and teardown functions as many
other test automation frameworks. In short, a test setup is something
that is executed before a test case and a test teardown is executed
after a test case. What makes a test teardown special is that it is
executed also when a test case fails, so it can be used for clean-up
activities that must be done regardless of the test case status. Both
a setup and a teardown can also easily be specified for all test cases
in a test suite, so using them avoids repetition.

In Robot Framework, a test setup or teardown is just a normal keyword
with possible arguments. It can either be a keyword from a library or
a higher-level user keyword.

The easiest way to specify a setup or a teardown for test cases in a
test suite is using the :opt:`Test Setup` and :opt:`Test
Teardown` settings in the Setting table. Individual test cases can
also have their own setup or teardown. They are defined with the
:opt:`[Setup]` or :opt:`[Teardown]` settings in the test case
table and they override possible :opt:`Test Setup` and
:opt:`Test Teardown` settings. Having no keyword after a
:opt:`[Setup]` or :opt:`[Teardown]` setting means having no
setup or teardown.


.. table:: Test setup and teardown examples
   :class: example

   =============  =================  =======  =======  
      Setting            Value        Value    Value  
   =============  =================  =======  =======  
   Test Setup     Open Application   App A    \
   Test Teardown  Close Application  \        \
   =============  =================  =======  =======  

.. table:: 
   :class: example

   ==================  ===============  ===================  ==================
       Test Case           Action            Argument            Argument
   ==================  ===============  ===================  ==================
   Default values      [Documentation]  Setup and teardown   from setting table
   \                   Do Something     \                    \
   \                   \                \                    \
   Overridden setup    [Documentation]  Own setup, teardown  from setting table
   \                   [Setup]          Open Application     App B
   \                   Do Something     \                    \
   \                   \                \                    \
   No teardown         [Documentation]  Default setup, no    teardown at all
   \                   Do Something     \                    \
   \                   [Teardown]       \                    \
   \                   \                \                    \
   Using variables     [Documentation]  Setup and teardown   given as variables
   \                   [Setup]          ${SETUP}             \
   \                   Do Something     \                    \
   \                   [Teardown]       ${TEARDOWN}          \
   ==================  ===============  ===================  ==================
  

Often when creating use-case-like test cases, the terms *precondition*
and *postcondition* are preferred over the terms setup and
teardown. Robot Framework supports also this terminology, so that a
precondition is a synonym to a setup and a postcondition to a
teardown.

.. table:: Setup and teardown synonyms
   :class: tabular

   =================  ===================
   Test Setup         Test Precondition
   Test Teardown      Test Postcondition
   [Setup]            [Precondition]
   [Teardown]         [Postcondition]
   =================  ===================

The name of the keyword to be executed as a setup or a teardown can be a
variable. This facilitates having different setups or teardowns in
different environments by giving the keyword name as a variable from
the command line.

.. Note:: `Test suites can have a setup and teardown of their
           own`__. A suite setup is executed before any test cases or sub test
           suites in that test suite, and similarly a suite teardown is
           executed after them.

__  `Suite setup and teardown`_


Different test case styles
~~~~~~~~~~~~~~~~~~~~~~~~~~

There are several different ways in which test cases may be written. Test
cases that describe some kind of *workflow* may be written either in
keyword-driven or behavior-driven style. Data-driven style can be used to test
the same workflow with varying input data.


Keyword-driven style
''''''''''''''''''''

Workflow tests, such as the :name:`Valid Login` test described earlier_, are
constructed from several keywords. Their normal structure is that first the
system is taken into the initial state (:name:`Open Login Page` in the
:name:`Valid Login` example), then something is done to the system
(:name:`Input Name`, :name:`Input Password`, :name:`Submit Credentials`), and
finally it is verified that the system behaved as expected (:name:`Welcome Page
Should Be Open`).

.. _earlier: example-tests_


Data-driven style
'''''''''''''''''

Another style to write test cases is the *data-driven* approach where test
cases contain only one higher-level keyword, normally created as `user
keywords`_. These kinds of tests are very useful when there is a need to test
the same workflow with different input or output data. This is demonstrated by
the example below.

.. table:: Example test cases using data-driven approach
   :class: example

   +-------------------+-------------------------+---------+---------+
   |     Test Case     |                         |User Name|Password |
   +===================+=========================+=========+=========+
   | Invalid User Name | Login With Invalid      | invalid | mode    |
   |                   | Credentials Should Fail |         |         |
   +-------------------+-------------------------+---------+---------+
   | Invalid Password  | Login With Invalid      | demo    | invalid |
   |                   | Credentials Should Fail |         |         |
   +-------------------+-------------------------+---------+---------+
   | Invalid User Name | Login With Invalid      | invalid | whatever|
   | And Password      | Credentials Should Fail |         |         |
   +-------------------+-------------------------+---------+---------+
   | Empty User Name   | Login With Invalid      |         | mode    |
   |                   | Credentials Should Fail |         |         |
   +-------------------+-------------------------+---------+---------+
   | Empty Password    | Login With Invalid      | demo    | \\      |
   |                   | Credentials Should Fail |         |         |
   +-------------------+-------------------------+---------+---------+
   | Empty User Name   | Login With Invalid      |         | \\      |
   | And Password      | Credentials Should Fail |         |         |
   +-------------------+-------------------------+---------+---------+

Note that in the example above, column headers have been changed to
match the data. This is possible because on the first row other cells
except the first one `are ignored`__. Additionally, backslash is used
for escaping_ empty cells at the end of the table.

__ `Ignored data`_


Behavior-driven style
'''''''''''''''''''''

It is also possible to write test cases as requirements that also non-technical
project stakeholders must understand. These `Executable Requirements` are a
corner stone of a process commonly called `Acceptance Test Driven Development`_
(ATDD).

One way to write these requirements/tests is *Given-When-Then* style
popularized by `Behavior Driven Development`_ (BDD). When writing test cases in
this style, the initial state is usually expressed with a keyword starting with
word :name:`Given`, the actions are described with keyword starting with
:name:`When` and the expectations with a keyword starting with :name:`Then`.
Keyword starting with :name:`And` may be used if a step has more than one
action.

.. table:: Example test cases using behavior-driven style
   :class: example

   ==================  ===========================
       Test Case                  Step
   ==================  ===========================
   Valid Login         Given login page is open
   \                   When valid username and password are inserted
   \                   and credentials are submitted
   \                   Then welcome page should be open
   ==================  ===========================

Ignoring :name:`Given/When/Then/And` prefixes
`````````````````````````````````````````````

Prefixes :name:`Given`, :name:`When`, :name:`Then` and :name:`And` are dropped
when matching keywords are searched, if no match with the full name is
found. This works for both user keywords and library keywords. For example,
:name:`Given login page is open` in the above example can be implemented as
user keyword either with or without the word :name:`Given`. Ignoring prefixes
also allows using the same keyword with different prefixes. For example
:name:`Welcome page should be open` could also used as :name:`And welcome page
should be open`.

.. note:: This feature is supported in Robot Framework 2.1.2 and newer.


Embedding data to keywords
``````````````````````````

When writing concrete examples it is useful to be able pass actual data to
keyword implementations. User keywords support this by allowing `embedding
arguments into keyword name`_.

